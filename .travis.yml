##### Configuration
dist: trusty
os: linux
sudo: require
language: cpp

notifications:
   email:
      recipients:     
         - boutwork@gmail.com 
      on_success: change
      on_failure: always

addons:
   apt:
      sources:
      - ubuntu-toolchain-r-test
      - llvm-toolchain-trusty-6.0
      packages:
      - g++-7
      - clang-6.0
      - clang-tidy-6.0

#before_install:
#   - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
#   - sudo apt-get update -qq

install:
#   - sudo apt-get install -qq g++-7
   - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 90

before_script:
   - mkdir build
   - cd build

matrix:
   include:
      - os: linux
        env: TEST="g++-7"
        script: cmake -DCMAKE_CXX_COMPILER="g++-7" .. && make -j 8
#      - os: linux
#        env: TEST="clang-6.0"
#        script: cmake -DCMAKE_CXX_COMPILER="clang-6.0" .. && make -j 8
      - os: linux
        env: TEST="whitespace"
        script: |
         if [[ -n $(git diff --check HEAD^) ]]; then
           echo "You must remove whitespace before submitting a pull request"
           git diff --check HEAD^
           exit -1
         fi
      - os: linux
        env: TEST="cppcheck"
        script: cmake -DENABLE_CPPCHECK=ON .. && make -j 8 && make check
      - os: linux
        env: TEST="clang-tidy"
        script: cmake -DENABLE_CLANG_TIDY=ON ..
      - os: linux
        env: TEST="Google Address Sanitizer"
        script: cmake -DENABLE_ASAN=ON .. && make -j 8
      - os: linux
        env: TEST="Google Undefined Sanitizer"
        script: cmake -DENABLE_USAN=ON .. && make -j 8
      - os: linux
        env: TEST="Google Thread Sanitizer"
        script: cmake -DENABLE_TSAN=ON .. && make -j 8

